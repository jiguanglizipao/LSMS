{% extends "base.html" %}

{% load static from staticfiles %}

{% block title %}数据导入/导出{% endblock %}

{% block leftside %}

{% block css %}

<style type="text/css">
    .UploadPath{
        float:left;
		padding:5px;
		color:#999;
		height:24px;
		line-height:24px;
		border:1px #ccc solid;
		width:160px;
		margin-right:4px;
        font: 14px "Microsoft YaHei", Verdana, Geneva, sans-serif;
    }
    .box{
        position:relative;
		float:left;
    }
    .FileInput{
		position:relative;
		right:0px;
		top:0px;
		opacity:0;
		filter:alpha(opacity=0);
		cursor:pointer;
		height:36px;
		overflow: hidden;
	}
    .ChooseFile{
		float:left;
		display:inline-block;
		padding:4px 16px;
		color:white;
		font:14px "Microsoft YaHei", Verdana, Geneva, sans-serif;
		cursor:pointer;
		background-color:purple;
		line-height:28px;
		text-decoration:none;
	}
</style>

{% endblock %}

<div class="ui vertical menu">
    <div class="header item">
        <i class="cloud icon"></i>
        数据库
    </div>
    <a href='{% url "excel.views.export_database" %}' class="ui blue button fluid">导出数据库</a>
    <br/>
    <form enctype="multipart/form-data" action="" method="POST" id="xml-form">
        <div class="box">
            <input type="text" id="DBUploadPath" class="UploadPath" value="Upload Path" disabled />
            <a href="javascript:void(0);" class="ChooseFile" onclick="UploadClick(this)">浏览</a>
            <input type="file" name="xml" class="FileInput" onchange="UpdatePath(this)" hidden />
        </div>
        <br/>
        <input id="xml-btn" type="button" class="ui red button fluid" value="导入数据库">
    </form>
</div>

<br/>
<div class="ui vertical menu">
    <div class="header item">
        <i class="cloud icon"></i>
        Excel
    </div>
    <a href='{% url "excel.views.export_excel" %}' class="ui button green fluid">生成Excel</a>
    <br/>
    <form enctype="multipart/form-data" action="" method="POST" id="excel-form">

        <!--<div class="ui form fluid">
            <div class="field">
                <label>导入Excel</label>
                <input type="file" name="xlsx" />
            </div>
        </div>-->
        <div class="box">
            <input type="text" id="ExcelUploadPath" class="UploadPath" value="Upload Path" disabled />
            <a href="javascript:void(0);" class="ChooseFile" onclick="UploadClick(this)">浏览</a>
            <input type="file" name="xlsx" class="FileInput" onchange="UpdatePath(this)" hidden />
        </div>
        <br/>
        <input id="excel-btn" type="button" class="ui red button fluid" value="导入Excel">
    </form>
</div>


{% endblock %}

{% block content %}
<div class="ui small modal" id="xml-confirm">
  <div class="header">操作确认</div>
  <div class="content">
    <div class="left"><i id="xml-confirm-icon"></i></div>
    <div class="right">
      <p>您确定要导入数据库吗？</p>
    </div>
  </div>
  <div class="actions">
    <div class="two fluid ui buttons">
      <div class="ui positive labeled icon button">
        <i class="checkmark icon"></i>
        确认
      </div>
      <div class="ui negative right labeled icon button">
        <i class="remove icon"></i>
        取消
      </div>
    </div>
  </div>
</div>
<div class="ui small modal" id="excel-confirm">
  <div class="header">操作确认</div>
  <div class="content">
    <div class="left"><i id="confirm-icon"></i></div>
    <div class="right">
      <p>您确定要导入Excel吗？</p>
    </div>
  </div>
  <div class="actions">
    <div class="two fluid ui buttons">
      <div class="ui positive labeled icon button">
        <i class="checkmark icon"></i>
        确认
      </div>
      <div class="ui negative right labeled icon button">
        <i class="remove icon"></i>
        取消
      </div>
    </div>
  </div>
</div>
<div id="mainContent">
</div>
{% endblock %}



{% block js %}
<script src="{% static "javascript/jquery.form.js" %}"></script>
<script type="text/javascript">
    function UpdatePath(obj){
        if($(obj).val()=='')
            $(obj).val('Upload Path');
        $(obj).parent().children(".UploadPath").val($(obj).val());
    }
    function UploadClick(obj){
        $(obj).parent().children(".FileInput").trigger("click");
    }
</script>
<script>
$(function(){
    $('#excel-confirm .positive.button').click(function() {
        $("#excel-form").ajaxSubmit({
            type:'post',
            url:'',
            success:function(data){
                $("#mainContent").html(data);
                Loaded()
            },
        });
    });
    $('#xml-confirm .positive.button').click(function() {
        $("#xml-form").ajaxSubmit({
            type:'post',
            url:'',
            success:function(data){
                $("#mainContent").html(data);
            },
        });
    });
    $("#excel-btn").on("click",function(){
        $('#excel-confirm').modal('show');
    });
    $("#xml-btn").on("click",function(){
        $('#xml-confirm').modal('show');
    });
});
</script>


{% endblock %}
{% extends "base.html" %}

{% load static from staticfiles %}

{% block title %}消息中心{% endblock %}

{% block allcontent %}
<!--<div class="sixteen wide column">-->
  <!--<table class="ui small table">-->
    <!--消息中心-->
  <!--</table>-->
<!--</div>-->
<div class="ui page grid">
  <div class="sixteen wide column">
    <h2 class="ui header" style="margin-top:10px; margin-left:10px">消息列表</h2>
    <table class="ui table segment small" style="margin-left:10px">
      <thead>
        <tr>
          <th width="10%">实物物品SN号</th>
          <th width="15%"></th>
          <th width="25%"></th>
          <th>信息内容</th>
        </tr>
      </thead>
      <tbody>
        {% for brw in goods %}
          <tr>
            <td class="goods-sn" style="font-size:20px;">
              <span class="ui green mini button" onclick="fold(this)" data-value="true">{{ brw.id }}</span>
            </td>
          </tr>
          {% for msg in brw.msgs %}
          <tr class="goods-id" data-value="{{ brw.id }}" hidden>
            <td></td>
            <td>
              {% if msg.direction == 'Send' %}
                <span style="color:Red; font-weight:bold;">{{ msg.associate }}</span>
              {% else %}
                <span style="color:Green; font-weight:bold;">{{ msg.associate }}</span>
              {% endif %}
            </td>
            <td>[<span style="color:Blue">{{ msg.time }}</span>]</td>
            <td>&nbsp;{{ msg.text }}</td>
          </tr>
          {% endfor %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
  function fold(obj){
    if($(obj).attr("data-value")=='true'){
      $(obj).attr("data-value","false");
      $(obj).attr("class","ui teal mini button");
      var id = $(obj).get(0).innerHTML;
      var collection = $("tr.goods-id");
      for(var i=0;i<collection.length;++i){
        if($(collection[i]).attr("data-value")==id){
          $(collection[i]).show();
        }
      }
    }
    else{
      $(obj).attr("data-value","true");
      $(obj).attr("class","ui green mini button");
      var id = $(obj).get(0).innerHTML;
      var collection = $("tr.goods-id");
      for(var i=0;i<collection.length;++i){
        if($(collection[i]).attr("data-value")==id){
          $(collection[i]).hide();
        }
      }
    }
  }
</script>

{% endblock %}
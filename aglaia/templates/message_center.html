{% extends "base.html" %}

{% load static from staticfiles %}

{% block title %}消息中心{% endblock %}

{% block allcontent %}

<div class="ui page grid">
    <h2 class="ui header" style="margin-top:10px; margin-left:10px">实物资源消息列表</h2>

    <div class="sixteen wide column">
        <table class="ui small table">
            <thead>
            <tr>
                <th width="10%">SN</th>
                <th width="20%">实物名称</th>
                <th width="30%">实物类型</th>
                <th width="30%">用户</th>
                <th width="10%">操作</th>
            </tr>
            </thead>
            <tbody>
            {% for brw in goods %}
                {% if brw.newMessage %}
                <tr>
                    <td>{{ brw.id }}</td>
                    <td>{{ brw.name }}
                        <div class="ui red label">新消息</div>&nbsp;
                    </td>
                    <td>{{ brw.type }}</td>
                    <td>{{ brw.user }}</td>
                    <td class="goods-sn" style="font-size:20px;">
                        <span class="ui green mini button msg-button" data-value="true" id="{{ brw.id }}">显示消息</span>
                    </td>
                </tr>
                {% if brw.msgs %}
                <tr>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden></th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden>▼</th>
                </tr>
                {% for msg in brw.msgs %}
                <tr class="{{ brw.id }}" data-value="{{ brw.id }}" hidden>
                    <td width="10%"></td>
                    <td width="20%">
                        {% if msg.direction == 'Send' %}
                        <div style="color:Red; font-weight:bold;">{{ msg.associate }}</div>
                        {% else %}
                        <div style="color:Green; font-weight:bold;">{{ msg.associate }}</div>
                        {% endif %}
                    </td>
                    <td width="30%">
                        <div style="color:Blue; display:inline">{{ msg.time }}</div>
                    </td>
                    <td width="30%">
                        {% if msg.flag == 'True' %}
                            <span style="font-weight:bold;">{{ msg.text }}</span>
                        {% else %}
                            <span style="color:grey;">{{ msg.text }}</span>
                        {% endif %}
                    </td>
                    <td width="10%"> </td>
                </tr>
                {% endfor %}
            <tr>
                <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden> </th>
                <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden>▲</th>
            </tr>
                {% endif %}
                {% endif %}
            {% endfor %}

            {% for brw in goods %}
                {% if not brw.newMessage %}
                <tr>
                    <td>{{ brw.id }}</td>
                    <td>{{ brw.name }}</td>
                    <td>{{ brw.type }}</td>
                    <td>{{ brw.user }}</td>
                    <td class="goods-sn" style="font-size:20px;">
                        <span class="ui green mini button msg-button" data-value="true" id="{{ brw.id }}">显示消息</span>
                    </td>
                </tr>
                {% if brw.msgs %}
                <tr>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden></th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden>▼</th>
                </tr>
                {% for msg in brw.msgs %}
                <tr class="{{ brw.id }}" data-value="{{ brw.id }}" hidden>
                    <td width="10%"></td>
                    <td width="20%">
                        {% if msg.direction == 'Send' %}
                        <div style="color:Red; font-weight:bold;">{{ msg.associate }}</div>
                        {% else %}
                        <div style="color:Green; font-weight:bold;">{{ msg.associate }}</div>
                        {% endif %}
                    </td>
                    <td width="30%">
                        <div style="color:Blue; display:inline">{{ msg.time }}</div>
                    </td>
                    <td width="30%">
                        {% if msg.flag == 'True' %}
                            <span style="font-weight:bold;">{{ msg.text }}</span>
                        {% else %}
                            <span style="color:grey;">{{ msg.text }}</span>
                        {% endif %}
                    </td>
                    <td width="10%"> </td>
                </tr>
                {% endfor %}
                <tr>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden> </th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ brw.id }}" data-value="{{ brw.id }}" width="10%" hidden>▲</th>
                </tr>
                {% endif %}
                {% endif %}
            {% endfor %}

        </table>
    </div>

    <h2 class="ui header" style="margin-top:10px; margin-left:10px">计算资源消息列表</h2>

    <div class="sixteen wide column">
        <table class="ui small table">
            <thead>
            <tr>
                <th width="10%">SN</th>
                <th width="20%">资源类型</th>
                <th width="30%">操作系统</th>
                <th width="30%">是否含有重要资源</th>
                <th width="10%">操作</th>
            </tr>
            </thead>
            <tbody>
            {% for comp in complist %}
                {% if comp.newMessage %}
                <tr>
                    <td>{{ comp.id }}</td>
                    <td>
                        {% if comp.pc_type == 'v' %}虚拟机
                        {% else %}实体机{% endif %}
                        <div class="ui red label">新消息</div>&nbsp;
                    </td>
                    <td>{{ comp.os }}</td>
                    <td>
                        {% if comp.flag == 'False' %}不含有
                        {% else %}含有{% endif %}
                    </td>
                    <td class="comps-sn" style="font-size:20px;">
                        <span class="ui green mini button msg-button" data-value="true" id="{{ comp.id }}">显示消息</span>
                    </td>
                </tr>
                {% if comp.msgs %}
                <tr>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden></th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden>▼</th>
                </tr>
                {% for msg in comp.msgs %}
                <tr class="{{ comp.id }}" data-value="{{ comp.id }}" hidden>
                    <td width="10%"></td>
                    <td width="20%">
                        {% if msg.direction == 'Send' %}
                        <div style="color:Red; font-weight:bold;">{{ msg.associate }}</div>
                        {% else %}
                        <div style="color:Green; font-weight:bold;">{{ msg.associate }}</div>
                        {% endif %}
                    </td>
                    <td width="30%">
                        <div style="color:Blue; display:inline">{{ msg.time }}</div>
                    </td>
                    <td width="30%">
                        {% if msg.flag == 'True' %}
                            <span style="font-weight:bold;">{{ msg.text }}</span>
                        {% else %}
                            <span style="color:grey;">{{ msg.text }}</span>
                        {% endif %}
                    </td>
                    <td width="10%"> </td>
                </tr>
                {% endfor %}
                <tr>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden> </th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden>▲</th>
                </tr>
            {% endif %}
            {% endif %}
            {% endfor %}

            {% for comp in complist %}
                {% if not comp.newMessage %}
                <tr>
                    <td>{{ comp.id }}</td>
                    <td>
                        {% if comp.pc_type == 'v' %}虚拟机
                        {% else %}实体机{% endif %}
                    </td>
                    <td>{{ comp.os }}</td>
                    <td>
                        {% if comp.flag == 'False' %}不含有
                        {% else %}含有{% endif %}
                    </td>
                    <td class="comps-sn" style="font-size:20px;">
                        <span class="ui green mini button msg-button" data-value="true" id="{{ comp.id }}">显示消息</span>
                    </td>
                </tr>
                {% if comp.msgs %}
                <tr>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden></th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden>▼</th>
                </tr>
                {% for msg in comp.msgs %}
                <tr class="{{ comp.id }}" data-value="{{ comp.id }}" hidden>
                    <td width="10%"></td>
                    <td width="20%">
                        {% if msg.direction == 'Send' %}
                        <div style="color:Red; font-weight:bold;">{{ msg.associate }}</div>
                        {% else %}
                        <div style="color:Green; font-weight:bold;">{{ msg.associate }}</div>
                        {% endif %}
                    </td>
                    <td width="30%">
                        <div style="color:Blue; display:inline">{{ msg.time }}</div>
                    </td>
                    <td width="30%">
                        {% if msg.flag == 'True' %}
                            <span style="font-weight:bold;">{{ msg.text }}</span>
                        {% else %}
                            <span style="color:grey;">{{ msg.text }}</span>
                        {% endif %}
                    </td>
                    <td width="10%"> </td>
                </tr>
                {% endfor %}
                <tr>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden> </th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="20%" hidden>操作者</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>操作时间</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="30%" hidden>消息内容</th>
                    <th class="{{ comp.id }}" data-value="{{ brw.id }}" width="10%" hidden>▲</th>
                </tr>
                {% endif %}
                {% endif %}
            {% endfor %}

        </table>
    </div>

</div>

{% endblock %}

{% block js %}

<script>

$(function() {
    $('.msg-button').click(function () {
        if ($(this).attr('data-value') == 'true') {
            $(this).attr('data-value', 'false');
            $(this).text('隐藏消息');
            $(this).removeClass('green').addClass('red');
            $('.' + this.id).show();
        } else {
            $(this).attr('data-value', 'true');
            $(this).text('显示消息');
            $(this).removeClass('red').addClass('green');
            $('.' + this.id).hide();
        }
    });
});

</script>

{% endblock %}
